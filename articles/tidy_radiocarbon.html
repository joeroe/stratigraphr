<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tidy radiocarbon analysis • stratigraphr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Tidy radiocarbon analysis">
<meta property="og:description" content="stratigraphr">
<meta property="og:image" content="/logo.svg">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@joeroe90">
<meta name="twitter:site" content="@joeroe90">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stratigraphr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cql.html">Chronological Query Language (CQL)</a>
    </li>
    <li>
      <a href="../articles/harris.html">Harris Matrices</a>
    </li>
    <li>
      <a href="../articles/tidy_radiocarbon.html">Tidy radiocarbon analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/joeroe/stratigraphr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="tidy_radiocarbon_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Tidy radiocarbon analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/joeroe/stratigraphr/blob/master/vignettes/tidy_radiocarbon.Rmd"><code>vignettes/tidy_radiocarbon.Rmd</code></a></small>
      <div class="hidden name"><code>tidy_radiocarbon.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://stratigraphr.joeroe.io">stratigraphr</a></span>)
</pre></div>
<p>stratigraphr includes a framework for working with radiocarbon dates in a tidy data analysis.</p>
<p>There are many existing packages that deal with radiocarbon data in R:</p>
<ul>
<li>
<strong>Data retrieval and cleaning</strong>: <a href="https://docs.ropensci.org/c14bazAAR/">c14bazAAR</a>
</li>
<li>
<strong>Calibration and modelling</strong>: <a href="https://github.com/ahb108/rcarbon">rcarbon</a>, <a href="https://github.com/ISAAKiel/oxcAAR">oxcAAR</a>, <a href="https://cran.r-project.org/web/packages/RChronoModel/index.html">RChronoModel</a>, <a href="https://andrewcparnell.github.io/Bchron/">BChron</a>, <a href="http://chrono.qub.ac.uk/blaauw/bacon.html">bacon</a>
</li>
<li>
<strong>Analysis:</strong> rcarbon (summed probability distributions, spatial analysis), <a href="https://www.math.sciences.univ-nantes.fr/~philippe/ArchaeoPhases.html">ArchaeoPhases</a> (post-processing of Bayesian models)</li>
</ul>
<p>The idea is not to duplicate these packages, but to provide tools that make it easier to use them together and with other packages in the extended <a href="https://www.tidyverse.org/">tidyverse</a>.</p>
<p>This vignette introduces some general principles for keeping radiocarbon data and models tidy, and describes how to carry out some common analysis tasks in that framework.</p>
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<ul>
<li>Keep uncalibrated dates in a tidy, tabular format (e.g. a <code>tibble</code> or <code>data.frame</code>) together with contextual data associated with the sample.</li>
<li>
<code>cal</code> objects are a generic representation of calibrated probability distributions that can be nested within tables to maintain their association with contextual data. Functions are provided to convert objects from a variety of other packages to and from the <code>cal</code> format.</li>
<li>
<code>c14_*</code> functions provide a consistent set of verbs for transforming radiocarbon data that work well with <code>dplyr</code>-style data manipulation and within functional analysis pipelines.</li>
</ul>
</div>
<div id="tidy-radiocarbon-data" class="section level2">
<h2 class="hasAnchor">
<a href="#tidy-radiocarbon-data" class="anchor"></a>Tidy radiocarbon data</h2>
<p>“Tidy data” <span class="citation">(Wickham 2014)</span> is a set of principles for organising datasets in a way that makes it easy to perform data analysis without tedious “data munging” between each step. In brief, tidy datasets are “rectangular” tables where:</p>
<ol style="list-style-type: decimal">
<li>Every column is variable.</li>
<li>Every row is an observation.</li>
<li>Every cell is a single value.</li>
</ol>
<p>Conventionally-reported uncalibrated radiocarbon dates <span class="citation">(Millard 2014)</span> are readily adapted into this format. Each row should represent a single sample, with the most important variables being the laboratory code, conventional radiocarbon age (CRA), and standard error. Further information about each sample, from the laboratory or about its context, should be stored in additional commons. The <code>shub1-radiocarbon</code> dataset <span class="citation">(Richter et al. 2017)</span>, including with this package, is an example of tidy radiocarbon data in a <code>tibble</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"shub1_radiocarbon"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">shub1_radiocarbon</span>)
<span class="co">#&gt;        lab_id context   phase                           sample</span>
<span class="co">#&gt; 1    RTD-7951      23 Phase 7         Context 126, Sample #465</span>
<span class="co">#&gt; 2 Beta-112146      24 Phase 7                        SHUB1/105</span>
<span class="co">#&gt; 3    RTD-7317      26 Phase 7          Context 83, Sample #392</span>
<span class="co">#&gt; 4    RTD-7318      27 Phase 7          Context 86, Sample #399</span>
<span class="co">#&gt; 5    RTD-7948      24 Phase 7         Context 120, Sample #455</span>
<span class="co">#&gt; 6    RTD-7947      22 Phase 6 Context 166, K25.14, Sample #430</span>
<span class="co">#&gt;                    material   cra error outlier</span>
<span class="co">#&gt; 1 Bolboschoenus sp. (tuber) 12166    55   FALSE</span>
<span class="co">#&gt; 2          gazelle dung (?) 12310    60   FALSE</span>
<span class="co">#&gt; 3 Bolboschoenus sp. (tuber) 12289    46   FALSE</span>
<span class="co">#&gt; 4 Zilla sp. (wood charcoal) 12332    46   FALSE</span>
<span class="co">#&gt; 5 Bolboschoenus sp. (tuber) 12478    38   FALSE</span>
<span class="co">#&gt; 6 Bolboschoenus sp. (tuber) 12322    38   FALSE</span>
</pre></div>
<p>Radiocarbon data from other sources might require some cleaning to get it into this format. <a href="https://tidyr.tidyverse.org/">tidyr</a> is a useful package for this (see <a href="https://github.com/joeroe/stratigraphr/blob/master/data-raw/shub1_radiocarbon.R">shub1_radiocarbon.R</a> for an example of how tidyr was used to clean the Shubayqa 1 dataset). Or if you are working with dates aggregated from multiple sources, <a href="https://docs.ropensci.org/c14bazAAR/">c14bazAAR</a> package provides many useful tools for automatically querying published databases and cleaning the results.</p>
<p>For this vignette, we will stick with the shub1 dataset.</p>
</div>
<div id="calibration" class="section level2">
<h2 class="hasAnchor">
<a href="#calibration" class="anchor"></a>Calibration</h2>
<p>The first step in any analysis of radiocarbon data is likely to be calibration. In <code>dplyr</code>’s grammar, calibration is a <em>mutation</em> of the original (uncalibrated) data; it creates a new variable (the calibrated probability distribution) for each observation based on a transformation based on some of the original variables (<code>cra</code>, <code>error</code>) and a number of other, fixed parameters (e.g. the calibration curve). Performing calibration with <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">dplyr::mutate()</a></code> is useful because it allows us to keep the result of this transformation together with the input data and associated contextual information.</p>
<p><code><a href="../reference/c14_calibrate.html">c14_calibrate()</a></code> is a wrapper for <code><a href="https://rdrr.io/pkg/rcarbon/man/calibrate.html">rcarbon::calibrate()</a></code> that can be used within <code>dplyr</code> statements:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st"><a href="https://dplyr.tidyverse.org">"dplyr"</a></span>)

<span class="kw">shub1_radiocarbon</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(cal = <span class="fu"><a href="../reference/c14_calibrate.html">c14_calibrate</a></span>(<span class="kw">cra</span>, <span class="kw">error</span>, <span class="kw">lab_id</span>, verbose = <span class="fl">FALSE</span>)) <span class="op">-&gt;</span>
  <span class="kw">shub1_radiocarbon</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">shub1_radiocarbon</span>)
<span class="co">#&gt; # A tibble: 6 x 9</span>
<span class="co">#&gt;   lab_id   context phase  sample       material       cra error outlier cal     </span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;        &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;lgl&gt;   &lt;list&gt;  </span>
<span class="co">#&gt; 1 RTD-7951      23 Phase… Context 126… Bolboschoen… 12166    55 FALSE   &lt;cal[,2…</span>
<span class="co">#&gt; 2 Beta-11…      24 Phase… SHUB1/105    gazelle dun… 12310    60 FALSE   &lt;cal[,2…</span>
<span class="co">#&gt; 3 RTD-7317      26 Phase… Context 83,… Bolboschoen… 12289    46 FALSE   &lt;cal[,2…</span>
<span class="co">#&gt; 4 RTD-7318      27 Phase… Context 86,… Zilla sp. (… 12332    46 FALSE   &lt;cal[,2…</span>
<span class="co">#&gt; 5 RTD-7948      24 Phase… Context 120… Bolboschoen… 12478    38 FALSE   &lt;cal[,2…</span>
<span class="co">#&gt; 6 RTD-7947      22 Phase… Context 166… Bolboschoen… 12322    38 FALSE   &lt;cal[,2…</span>
</pre></div>
<p>The calibrated dates are stored as a <a href="https://tidyr.tidyverse.org/articles/nest.html">nested column</a> of <code>cal</code> objects (see below). To work with the probability distributions directly (e.g. to plot them with <code>ggplot2</code>) we will eventually need to expand this column into a “long” format, where each year from each sample is its own row, using <code>[tidyr::unnest()]</code>. But for now the nested table is helpful for keeping our master dataset readable.</p>
<div id="the-cal-class" class="section level3">
<h3 class="hasAnchor">
<a href="#the-cal-class" class="anchor"></a>The <code>cal</code> class</h3>
<p>stratigraphr uses the <code>cal</code> S3 class as a generic representation of calibrated radiocarbon dates. This is a data.frame with two columns containing the range of calendar years (<code>year</code>) and associated probability densities (<code>p</code>). Metadata associated with the calibration, such as the era system and atmospheric curve used, are stored as attributes that can be accessed with <code><a href="../reference/cal_metadata.html">cal_metadata()</a></code>.</p>
<p>Most other radiocarbon packages have similar structures for storing calibrated dates, differing primarily in how metadata is handled. The <code>c14_*</code> functions described here are designed to seamlessly convert between these object types when functions from other packages are invoked. However, if you need to, you can directly construct a <code>cal</code> object from a vector of probabilities with <code><a href="../reference/cal.html">cal()</a></code>, or from various other types of object with <code><a href="../reference/as_cal.html">as_cal()</a></code>.</p>
<p>The <code>cal</code> class also has methods for pretty-printing calibrated dates:</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">shub1_radiocarbon</span><span class="op">$</span><span class="kw">cal</span>[[<span class="fl">1</span>]]
<span class="co">#&gt; # Calibrated probability distribution from 14805 to 13796 cal BP</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       +--+---------+--*-----+---------+---------+---------+----+</span>
<span class="co">#&gt; 0.008 +              ***                                       +</span>
<span class="co">#&gt;       |              * *                                       |</span>
<span class="co">#&gt; 0.006 +             ** **                                      +</span>
<span class="co">#&gt; 0.004 +             *   *                                      +</span>
<span class="co">#&gt;       |             *   ***                                    |</span>
<span class="co">#&gt; 0.002 +     ****   **     **                                   +</span>
<span class="co">#&gt;       |  ****  *****       ********                            |</span>
<span class="co">#&gt;     0 +-**---------+--------+-----**--+---------+-----*****----+</span>
<span class="co">#&gt;        13800     14000    14200     14400     14600     14800</span>
<span class="co">#&gt; Lab ID: RTD-7951</span>
<span class="co">#&gt; Uncalibrated: 12166±55 uncal BP</span>
<span class="co">#&gt; era: cal BP</span>
<span class="co">#&gt; curve: intcal20</span>
<span class="co">#&gt; reservoir_offset: 0</span>
<span class="co">#&gt; reservoir_offset_error: 0</span>
<span class="co">#&gt; calibration_range: 55000–0 BP</span>
<span class="co">#&gt; normalised: TRUE</span>
<span class="co">#&gt; F14C: FALSE</span>
<span class="co">#&gt; p_cutoff: 1e-05</span>
</pre></div>
<p>And calculating meaningful summary statistics, such as the minimum and maximum of the calibrated range:</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="co"># See https://github.com/joeroe/stratigraphr/issues/7</span>
<span class="co"># min(shub1_radiocarbon$cal)</span>
<span class="co"># max(shub1_radiocarbon$cal)</span>
</pre></div>
</div>
</div>
<div id="visualising-radiocarbon-data-with-ggplot2" class="section level2">
<h2 class="hasAnchor">
<a href="#visualising-radiocarbon-data-with-ggplot2" class="anchor"></a>Visualising radiocarbon data with <code>ggplot2</code>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st"><a href="http://ggplot2.tidyverse.org">"ggplot2"</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st"><a href="https://tidyr.tidyverse.org">"tidyr"</a></span>)
<span class="kw">shub1_radiocarbon</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="op">!</span><span class="kw">outlier</span>) <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">cal</span>)) <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">year</span>, y = <span class="kw">p</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span>(<span class="kw">lab_id</span>), ncol = <span class="fl">1</span>, scales = <span class="st">"free_y"</span>, strip.position = <span class="st">"left"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(x = <span class="st">"cal BP"</span>, y = <span class="kw">NULL</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(axis.text.y = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
        axis.ticks.y = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
        panel.grid.major.y = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
        panel.grid.minor.y = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
        strip.text.y.left = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(angle = <span class="fl">0</span>))
</pre></div>
<p><img src="tidy_radiocarbon_files/figure-html/plot-cal-1.png" width="700"></p>
</div>
<div id="modelling-radiocarbon-data" class="section level2">
<h2 class="hasAnchor">
<a href="#modelling-radiocarbon-data" class="anchor"></a>Modelling radiocarbon data</h2>
<div id="summed-probability-distributions" class="section level3">
<h3 class="hasAnchor">
<a href="#summed-probability-distributions" class="anchor"></a>Summed probability distributions</h3>
<p>In <code>dplyr</code>’s grammar, summing radiocarbon dates is a <em>summary</em> of the original data, because it reduces the number of observations. <code>c14_sum</code> is a wrapper for <code><a href="https://rdrr.io/pkg/rcarbon/man/spd.html">rcarbon::spd()</a></code> that can be used in a <code>dplyr</code> statement.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="kw">shub1_radiocarbon</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="kw">phase</span>) <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(spd = <span class="fu"><a href="../reference/c14_sum.html">c14_sum</a></span>(<span class="kw">cal</span>, verbose = <span class="fl">FALSE</span>), .groups = <span class="st">"drop_last"</span>) <span class="op">-&gt;</span>
  <span class="kw">shub1_spd</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">shub1_spd</span>)
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;   phase   spd                       </span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;list&gt;                    </span>
<span class="co">#&gt; 1 Phase 1 &lt;CalGrid[,2] [11,652 × 2]&gt;</span>
<span class="co">#&gt; 2 Phase 2 &lt;CalGrid[,2] [560 × 2]&gt;   </span>
<span class="co">#&gt; 3 Phase 3 &lt;CalGrid[,2] [473 × 2]&gt;   </span>
<span class="co">#&gt; 4 Phase 4 &lt;CalGrid[,2] [1,230 × 2]&gt; </span>
<span class="co">#&gt; 5 Phase 5 &lt;CalGrid[,2] [1,324 × 2]&gt; </span>
<span class="co">#&gt; 6 Phase 6 &lt;CalGrid[,2] [1,123 × 2]&gt;</span>
</pre></div>
</div>
<div id="bayesian-calibration" class="section level3">
<h3 class="hasAnchor">
<a href="#bayesian-calibration" class="anchor"></a>Bayesian calibration</h3>
<p>See <code><a href="../articles/cql.html">vignette("cql")</a></code>.</p>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-Millard2014-tr">
<p>Millard, Andrew R. 2014. “Conventions for Reporting Radiocarbon Determinations.” <em>Radiocarbon</em> 56 (2): 555–59. <a href="https://doi.org/10.2458/56.17455">https://doi.org/10.2458/56.17455</a>.</p>
</div>
<div id="ref-Richter2017-xy">
<p>Richter, Tobias, Amaia Arranz-Otaegui, Lisa Yeomans, and Elisabetta Boaretto. 2017. “High Resolution AMS Dates from Shubayqa 1, Northeast Jordan Reveal Complex Origins of Late Epipalaeolithic Natufian in the Levant.” <em>Scientific Reports</em> 7 (1): 17025. <a href="https://doi.org/10.1038/s41598-017-17096-5">https://doi.org/10.1038/s41598-017-17096-5</a>.</p>
</div>
<div id="ref-Wickham2014-ud">
<p>Wickham, Hadley. 2014. “Tidy Data.” <em>Journal of Statistical Software</em> 59 (10): 1–23. <a href="https://doi.org/10.18637/jss.v059.i10">https://doi.org/10.18637/jss.v059.i10</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://joeroe.io">Joe Roe</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
